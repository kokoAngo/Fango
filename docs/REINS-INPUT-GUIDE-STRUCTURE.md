# REINS 入力ガイド構造分析

## 入力ガイドボタン配置（index順）

| Index | 対象フィールド | 説明 |
|-------|---------------|------|
| 0 | 所在地1 | 都道府県名 |
| 1 | 所在地2 | 都道府県名 |
| 2 | 所在地3 | 都道府県名 |
| 3 | 沿線1 | 沿線名 |
| 4 | 沿線2 | 沿線名 |
| 5 | 沿線3 | 沿線名 |
| 6 | 設備・条件・住宅性能等 | チェックボックス選択 |

---

## 所在地選択フロー（3画面構成）

### 画面1: 地方・都道府県選択

| Select Index | 項目 | オプション例 |
|-------------|------|-------------|
| **Select 0** | 地方 | "東日本" (value="1"), "中部圏" (value="2"), "近畿圏" (value="3"), "西日本" (value="4") |
| **Select 1** | 都道府県 | "北海道" (value="01"), "東京都" (value="13"), etc. |

**操作**: 両方選択後「次へ」クリック

### 画面2: 地域区分・市区町村選択

| Select Index | 項目 | オプション例（東京都の場合） |
|-------------|------|---------------------------|
| **Select 0** | 地域区分 | "23区" (value="1"), "その他" (value="2") |
| **Select 1** | 市区町村 | "千代田区" (value="101"), "新宿区" (value="104"), etc. |

**操作**: 両方選択後「次へ」クリック

### 画面3: 詳細地点・町丁目選択

| Select Index | 項目 | オプション例 |
|-------------|------|-------------|
| **Select 0** | 詳細地点 | 選択された市区町村に依存 |
| **Select 1** | 町丁目 | "全域" (value="00"), "飯田橋１丁目" (value="01"), etc. |

**操作**: Select 1で「全域」または特定町丁目を選択後「決定」クリック

**重要**:
- Select 1の最初のオプションは通常「全域」（全域を検索する場合はこれを選択）
- 「決定」ボタンでモーダルを閉じ、選択を確定

---

## 沿線・駅選択フロー（3画面構成）

### 画面1: 地方・都道府県選択

| Select Index | 項目 | オプション（値） |
|-------------|------|-----------------|
| **Select 0** | 地方 | "東日本" (value="1"), "中部圏" (value="2"), "近畿圏" (value="3"), "西日本" (value="4") |
| **Select 1** | 都道府県 | "北海道" (value="01"), "東京都" (value="13"), etc. |

**操作**: 両方選択後「次へ」クリック

### 画面2: 沿線選択（カナ行フィルター方式）

| Select Index | 項目 | オプション（値） |
|-------------|------|-----------------|
| **Select 0** | 行フィルター | "あ行" (value="01"), "か行" (value="02"), "さ行" (value="03"), "た行" (value="04"), "な行" (value="05"), "は行" (value="06"), "ま行" (value="07"), "や行" (value="08"), "ら行" (value="09") |
| **Select 1** | 沿線リスト | Select 0選択後に動的に表示。例: "山手線" (value="2172山手線"), "有楽町線" (value="2347有楽町線") |

**操作**:
1. Select 0で行を選択（例: 山手線なら「や行」）
2. Select 1が動的に更新され、該当沿線リストが表示
3. Select 1で沿線を選択
4. 「次へ」クリック

**沿線検索のコツ**:
- 沿線名の読みの最初の文字で行を選択
- 例: 山手線(やまのてせん) → 「や行」
- 例: 中央線(ちゅうおうせん) → 「た行」
- 例: 銀座線(ぎんざせん) → 「か行」

### 画面3: 駅選択（区間指定方式）

| Select Index | 項目 | 説明 |
|-------------|------|------|
| **Select 0** | 始発駅 | 検索範囲の開始駅 |
| **Select 1** | 終点駅 | 検索範囲の終了駅 |

**山手線の駅リスト例**:
```
"東京" (value="010")
"有楽町" (value="020")
"新橋" (value="030")
"浜松町" (value="040")
"田町" (value="050")
"高輪ゲートウェイ" (value="056")
"品川" (value="060")
"大崎" (value="070")
"五反田" (value="080")
"目黒" (value="090")
"恵比寿" (value="100")
"渋谷" (value="110")
"原宿" (value="120")
"代々木" (value="130")
"新宿" (value="140")
"新大久保" (value="150")
"高田馬場" (value="160")
"目白" (value="170")
"池袋" (value="180")
"大塚" (value="190")
"巣鴨" (value="200")
"駒込" (value="210")
"田端" (value="220")
"西日暮里" (value="230")
"日暮里" (value="240")
"鶯谷" (value="250")
"上野" (value="260")
"御徒町" (value="270")
"秋葉原" (value="280")
"神田" (value="290")
"東京" (value="300")
```

**操作**:
1. Select 0で始発駅を選択
2. Select 1で終点駅を選択
3. 「決定」クリック

---

## 実装のためのコードパターン

### モーダル内のSelect要素取得

```javascript
const modal = document.querySelector('.modal.show, .modal');
const selects = modal.querySelectorAll('select');
// selects[0] = 最初のSelect
// selects[1] = 2番目のSelect
```

### Select値の設定とイベント発火

```javascript
// テキストで選択
for (const opt of selects[0].options) {
  if (opt.text === '東京都') {
    opt.selected = true;
    selects[0].dispatchEvent(new Event('change', { bubbles: true }));
    break;
  }
}

// 値で選択
selects[0].value = '13';
selects[0].dispatchEvent(new Event('change', { bubbles: true }));
```

### ボタンクリック

```javascript
const buttons = modal.querySelectorAll('button');
for (const btn of buttons) {
  if (btn.textContent?.trim() === '次へ') {
    btn.click();
    break;
  }
}
```

---

## 地方・都道府県マッピング

### 地方コード
| 地方 | value |
|------|-------|
| 東日本 | 1 |
| 中部圏 | 2 |
| 近畿圏 | 3 |
| 西日本 | 4 |

### 都道府県コード（一部）
| 都道府県 | value |
|---------|-------|
| 北海道 | 01 |
| 東京都 | 13 |
| 神奈川県 | 14 |
| 大阪府 | 27 |
| 京都府 | 26 |
| 愛知県 | 23 |
| 福岡県 | 40 |

---

## 注意事項

1. **Select変更後の待機**: Select変更後は1000-1500ms待機が必要（動的コンテンツ更新のため）
2. **次へ/決定後の待機**: ボタンクリック後は2000-2500ms待機が必要
3. **changeイベント**: `{ bubbles: true }`を必ず指定
4. **エラーハンドリング**: 各ステップでスクリーンショットを保存して問題を診断
