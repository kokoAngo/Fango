/**
 * 沿線名からカナ行へのマッピング
 * 沿線の読みの最初の文字でカナ行を判定
 */

// カナ行の値
const KANA_ROWS = {
  'あ行': '01',
  'か行': '02',
  'さ行': '03',
  'た行': '04',
  'な行': '05',
  'は行': '06',
  'ま行': '07',
  'や行': '08',
  'ら行': '09'
};

// 主要路線の読みとカナ行マッピング
const LINE_KANA_MAP = {
  // あ行 (あいうえお)
  '青梅線': 'あ行',
  '有楽町線': 'や行', // ゆうらくちょう
  '井の頭線': 'あ行',
  '内房線': 'あ行',
  '宇都宮線': 'あ行',
  '大江戸線': 'あ行',
  '小田急線': 'あ行',
  '小田急小田原線': 'あ行',
  '小田急多摩線': 'あ行',
  '小田急江ノ島線': 'あ行',

  // か行 (かきくけこ、がぎぐげご)
  '京王線': 'か行',
  '京王新線': 'か行',
  '京王相模原線': 'か行',
  '京王井の頭線': 'か行',
  '京浜東北線': 'か行',
  '京成線': 'か行',
  '京成本線': 'か行',
  '京急線': 'か行',
  '京急本線': 'か行',
  '銀座線': 'か行', // ぎんざ
  '高崎線': 'た行', // たかさき
  '外房線': 'か行', // がいぼう

  // さ行 (さしすせそ、ざじずぜぞ)
  '埼京線': 'さ行',
  '湘南新宿ライン': 'さ行',
  '常磐線': 'さ行', // じょうばん
  '上越新幹線': 'さ行', // じょうえつ
  '相鉄線': 'さ行', // そうてつ
  '西武線': 'さ行',
  '西武新宿線': 'さ行',
  '西武池袋線': 'さ行',
  '総武線': 'さ行', // そうぶ
  '総武本線': 'さ行',

  // た行 (たちつてと、だぢづでど)
  '高崎線': 'た行',
  '千代田線': 'た行', // ちよだ
  '中央線': 'た行', // ちゅうおう
  '中央本線': 'た行',
  '中央快速線': 'た行',
  '中央総武線': 'た行',
  '東海道線': 'た行',
  '東海道本線': 'た行',
  '東海道新幹線': 'た行',
  '東急線': 'た行',
  '東急東横線': 'た行',
  '東急田園都市線': 'た行',
  '東急目黒線': 'た行',
  '東急池上線': 'た行',
  '東急大井町線': 'た行',
  '東武線': 'た行',
  '東武伊勢崎線': 'た行',
  '東武東上線': 'た行',
  '東武スカイツリーライン': 'た行',
  '都営新宿線': 'た行',
  '都営三田線': 'た行',
  '都営浅草線': 'た行',
  '都営大江戸線': 'た行',
  '東西線': 'た行',
  'つくばエクスプレス': 'た行',

  // な行 (なにぬねの)
  '南武線': 'な行',
  '成田線': 'な行',
  '成田エクスプレス': 'な行',
  '日比谷線': 'な行', // ひびや → 実際は「は行」

  // は行 (はひふへほ、ばびぶべぼ、ぱぴぷぺぽ)
  '半蔵門線': 'は行',
  '日比谷線': 'は行',
  '副都心線': 'は行', // ふくとしん
  '武蔵野線': 'ま行', // むさしの

  // ま行 (まみむめも)
  '丸ノ内線': 'ま行',
  '丸の内線': 'ま行',
  '武蔵野線': 'ま行',
  'みなとみらい線': 'ま行',
  '目黒線': 'ま行', // めぐろ

  // や行 (やゆよ)
  '山手線': 'や行',
  '有楽町線': 'や行',
  '横須賀線': 'や行',
  '横浜線': 'や行',
  'ゆりかもめ': 'や行',

  // ら行 (らりるれろ)
  'りんかい線': 'ら行',

  // JRプレフィックス付き
  'JR山手線': 'や行',
  'JR中央線': 'た行',
  'JR総武線': 'さ行',
  'JR京浜東北線': 'か行',
  'JR埼京線': 'さ行',
  'JR横浜線': 'や行',
  'JR横須賀線': 'や行',
  'JR湘南新宿ライン': 'さ行',
  'JR東海道線': 'た行',
  'JR高崎線': 'た行',
  'JR宇都宮線': 'あ行',
  'JR常磐線': 'さ行',
  'JR武蔵野線': 'ま行',
  'JR南武線': 'な行',
  'JR青梅線': 'あ行',
  'JR内房線': 'あ行',
  'JR外房線': 'か行',
  'JR成田線': 'な行',

  // メトロプレフィックス付き
  '東京メトロ銀座線': 'か行',
  '東京メトロ丸ノ内線': 'ま行',
  '東京メトロ日比谷線': 'は行',
  '東京メトロ東西線': 'た行',
  '東京メトロ千代田線': 'た行',
  '東京メトロ有楽町線': 'や行',
  '東京メトロ半蔵門線': 'は行',
  '東京メトロ南北線': 'な行',
  '東京メトロ副都心線': 'は行',

  // 福岡市営地下鉄（くうこう、はこざき、ななくま）
  '空港線': 'か行',
  '地下鉄空港線': 'か行',
  '福岡市地下鉄空港線': 'か行',
  '福岡市営空港線': 'か行',
  '福岡市営地下鉄空港線': 'か行',
  '箱崎線': 'は行',
  '地下鉄箱崎線': 'は行',
  '福岡市地下鉄箱崎線': 'は行',
  '福岡市営箱崎線': 'は行',
  '七隈線': 'な行',
  '地下鉄七隈線': 'な行',
  '福岡市地下鉄七隈線': 'な行',
  '福岡市営七隈線': 'な行',

  // 仙台
  '仙台空港線': 'さ行',
  '仙台空港アクセス線': 'さ行',
  '仙台市地下鉄南北線': 'さ行',
  '仙台市地下鉄東西線': 'さ行',

  // 札幌
  '札幌市営地下鉄南北線': 'さ行',
  '札幌市営地下鉄東西線': 'さ行',
  '札幌市営地下鉄東豊線': 'さ行'
};

/**
 * 沿線名からカナ行を取得
 * @param {string} lineName - 沿線名
 * @returns {string|null} - カナ行名（「あ行」など）またはnull
 */
function getKanaRowForLine(lineName) {
  if (!lineName) return null;

  // 直接マッピングを確認
  if (LINE_KANA_MAP[lineName]) {
    return LINE_KANA_MAP[lineName];
  }

  // 部分一致で検索
  for (const [key, value] of Object.entries(LINE_KANA_MAP)) {
    if (lineName.includes(key) || key.includes(lineName)) {
      return value;
    }
  }

  return null;
}

/**
 * カナ行名からvalueを取得
 * @param {string} kanaRow - カナ行名（「あ行」など）
 * @returns {string|null} - value（"01"など）またはnull
 */
function getKanaRowValue(kanaRow) {
  return KANA_ROWS[kanaRow] || null;
}

/**
 * 地方コードマッピング
 */
const REGION_MAP = {
  '東日本': '1',
  '中部圏': '2',
  '近畿圏': '3',
  '西日本': '4'
};

/**
 * 都道府県から地方を判定
 */
function getRegionForPrefecture(prefecture) {
  const eastJapan = ['北海道', '青森', '岩手', '宮城', '秋田', '山形', '福島', '茨城', '栃木', '群馬', '埼玉', '千葉', '東京', '神奈川', '新潟', '山梨', '長野'];
  const chubu = ['富山', '石川', '福井', '岐阜', '静岡', '愛知', '三重'];
  const kinki = ['滋賀', '京都', '大阪', '兵庫', '奈良', '和歌山'];
  // 西日本はその他すべて

  const normalizedPref = prefecture.replace(/[都府県]$/, '');

  if (eastJapan.some(p => normalizedPref.includes(p) || p.includes(normalizedPref))) {
    return '東日本';
  }
  if (chubu.some(p => normalizedPref.includes(p) || p.includes(normalizedPref))) {
    return '中部圏';
  }
  if (kinki.some(p => normalizedPref.includes(p) || p.includes(normalizedPref))) {
    return '近畿圏';
  }
  return '西日本';
}

module.exports = {
  KANA_ROWS,
  LINE_KANA_MAP,
  REGION_MAP,
  getKanaRowForLine,
  getKanaRowValue,
  getRegionForPrefecture
};
